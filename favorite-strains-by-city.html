<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<!-- Google fonts -->
<link href="https://fonts.googleapis.com/css?family=Open+Sans:400,300" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Favorite Strains by Major City</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script> 
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-legend/1.3.0/d3-legend.js" charset="utf-8"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css">
<script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="css/main.css">
<link rel="stylesheet" href="css/all.min.css">
<link rel="stylesheet" href="css/bulma.min.css">
<link rel="stylesheet" href="css/custom.css">
<link rel="stylesheet" href="css/highlight.css">
</head>

<style>
section.custom_a {
    background-color: rgba(154, 130, 139, 0.77);
}
div.move_up_15pixels {
    margin-top: -15px;
}
a.no_underline {
    text-decoration: none;
}
a.no_underline_on_hover a:hover {
    text-decoration: none;
}
figure.force_left {
    justify-content: left;
}
div.float_to_top {
    vertical-align: top;
}
h3.float_to_top {
    vertical-align: top;
}
#my_id {
    display: none;
}
</style>
<body>
<nav class="navbar is-dark is-bold hidden-print has-text-centered-mobile">
  <div class="container is-dark is-bold hidden-print ">
    <div class="navbar-brand" style="h1"> <a class="navbar-item no_underline no_underline_on_hover" href="#" style="font-weight: bolder"> Prometheus Insights </a> <span class="navbar-burger burger" data-target="navMenu"> <span></span> <span></span> <span></span> </span> </div>
    <div id="navMenu" class="navbar-menu">
      <div class="navbar-end"> <a href="/index.html" class="navbar-item no_underline">Home</a> <a href="/connect.html" class="navbar-item no_underline">Connect</a> </div>
    </div>
  </div>
</nav>
<section class="section">
  <div class="container has-text-centered-mobile">
    <div class="content has-text-centered">
      <h3 align="center">Favorite Strains and Dispensaries by City</h3>
      <div class="columns has-text-centered is-center">
        <div class="column is-full">
          <div class="control has-icons-left has-text-centered">
            <div class="select is-small"> <span class="icon is-small is-left"> <i class="fas fa-globe"></i> </span>
              <select id="city" onChange="reload(this.value)">
                <option value="data/data_la.json">Los Angeles</option>
                <option value="data/data_sf.json" selected> San Francisco Bay Area</option>
                <option value="data/data_nyc.json" selected> New York City</option>
              </select>
            </div>
          </div>
        </div>
      </div>
      <hr>
      <div class="columns has-text-centered">
        <div class="column is-full"> 
          <script>
			////////////////////////////////////////////////////////////// 
			//////////////////////// Set-Up ////////////////////////////// 
			////////////////////////////////////////////////////////////// 

			var margin = {top: 100, right: 100, bottom: 100, left: 100},
				legendPosition = {x: 25, y: 25},
				width = Math.min(700, window.innerWidth - 10) - margin.left - margin.right,
				height = Math.min(width, window.innerHeight - margin.top - margin.bottom - 20);
					
			////////////////////////////////////////////////////////////// 
			//////////////////// Draw the Chart ////////////////////////// 
			////////////////////////////////////////////////////////////// 

			var color = d3.scale.ordinal()
				.range(["#EDC951","#CC333F","#00A0B0"]);
				
			var radarChartOptions = {
			  w: width,
			  h: height,
			  margin: margin,
			  legendPosition: legendPosition,
			  maxValue: 0.5,
			  wrapWidth: 60,
			  levels: 5,
			  roundStrokes: true,
			  color: color,
			  axisName: "reason",
			  areaName: "device",
			  value: "value"
			};

			//Load the data and Call function to draw the Radar chart
			//d3.json("data_nyc.json", function(error, data){
			//	RadarChart(".radarChart", data, radarChartOptions);
			//});
			
		</script>
          <div class="dynamicRadarChart" style="max-width: 650px; display: block; margin: auto;" align="center"></div>
          <script src="dynamicRadarChart.js"></script> 
          <script>
			////////////////////////////////////////////////////////////// 
			//////////////////////// Set-Up ////////////////////////////// 
			////////////////////////////////////////////////////////////// 

			
			var dynamicMargin = {top: 100, right: 100, bottom: 100, left: 100},
				legendPosition = {x: 25, y: 25},
				width = Math.min(700, window.innerWidth - 10) - margin.left - margin.right,
				height = Math.min(width, window.innerHeight - margin.top - margin.bottom - 20);
					
			////////////////////////////////////////////////////////////// 
			//////////////////// Draw the Chart ////////////////////////// 
			////////////////////////////////////////////////////////////// 

			var color = d3.scale.ordinal()
				.range(["#EDC951","#CC333F","#00A0B0"]);
				
			var dynamicRadarChartOptions = {
			  //w: width,
			  //h: height,
			  margin: dynamicMargin,
			  legendPosition: legendPosition,
			  maxValue: 0.5,
			  wrapWidth: 60,
			  levels: 5,
			  roundStrokes: true,
			  color: color,
			  axisName: "reason",
			  areaName: "device",
			  value: "value"
			};
			
			var e = document.getElementById("city");
			var strUser = e.options[e.selectedIndex].value;
			console.log("value: ", strUser);

			//Load the data and Call function to draw the Radar chart
			d3.json(strUser, function(error, data){
				DynamicRadarChart(".dynamicRadarChart", data, dynamicRadarChartOptions);
			});
			  
			  
			function reload(city_data) {
		        console.log("value: ", "hello");
			    d3.json(city_data, function(error, data){
			    DynamicRadarChart(".dynamicRadarChart", data, dynamicRadarChartOptions);
			    });
			}
			
		</script> 
        </div>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="content">
      <div class="columns has-text-centered">
        <div class="column is-full">
          <h4>Step 1: Building upon Existing Open Source Code</h4>
          <p>This visual has been built off modified source code from visualcinnamon [5]. At first, the chart only displayed in full on desktop and some tablets, but I was able to modify the source code so that this rechart dynamically resizes based on the device you are browsing on.
            After some research, I saw that Github's saiskee [6] had already built a script to scrape leafly. However, since then, leafly has restructured their website and the script had to be brought to date.</p>
          <h4>Step 2: Finding the Data</h4>
          <p>Unfortunately, neither Leafly nor Weedmaps have publicly available rankings of strain by city. So I just went to the first page of google and took one hybrid, sative, and indica from each of those articles per city.
            The rest was just an issue of plugging those names into my newly fixed Leafly Web-Scraper, and outputting a new JSON
            file for each city.</p>
        </div>
      </div>
    </div>
  </div>
  <div class="container">
    <div class="content">
      <div class="columns has-text-centered">
        <div class="column is-full">
          <h4>Sources</h4>
          <p>1. https://www.leafly.com/strains/</p>
          <p>2. https://www.civilized.life/articles/most-popular-marijuana-strains-in-new-york/</p>
          <p>3. https://www.leafly.com/news/strains-products/top-10-cannabis-strains-in-california/</p>
          <p>4. https://wheresweed.com/strains/california/bay-area/sativa/best-rated</p>
          <p>5. https://www.visualcinnamon.com/2015/10/different-look-d3-radar-chart.html</p>
          <p>6. https://github.com/saiskee/Leafly-scraper</p>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Comment --> 
</section>
<footer class="footer has-text-centered has-text-centered-mobile"> Email us at: <br>
  info@prometheusinsights.com</footer>
</body>
</html>